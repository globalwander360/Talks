auditExportToExcel() {
  const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;

  const exportBody: Export = {
    columns: this.header.map(h => h.name),
    excelHeaders: this.header.map(h => h.name),
    pgpeCodes: []
  };

  this.eventService.exportAudit(
    this.branchCode,
    this.countryCode,
    'BNPPUID',
    this.eventId,
    'en',
    0,
    this.totalCount,
    'columnName',
    'ASC',
    timeZone,
    exportBody,
    'body',
    true
  ).subscribe({
    next: (response: any) => {
      const blob = new Blob([response], {
        type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
      });

      const link = document.createElement('a');
      link.href = window.URL.createObjectURL(blob);
      link.download = 'Audit_Report.xlsx';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      window.URL.revokeObjectURL(link.href);
    },
    error: (error) => {
      console.error('Export failed:', error);
    }
  });
}
