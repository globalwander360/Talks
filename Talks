exportToExcel() {
  const timeZone = Intl.DateTimeFormat().resolvedOptions().timeZone;

  const exportBody = {
    columns: this.header.map(h => h.field),
    excelHeaders: this.header.map(h => h.header),
    pgpeCodes: []
  };

  this.eventService.exportAudit(
    this.branchCode,
    this.countryCode,
    'BNPPUID',
    'en',
    0,
    this.totalCount,
    'columnName',
    'asc',
    exportBody,
    timeZone
  ).subscribe((response: Blob) => {
    const blob = new Blob([response], {
      type: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'
    });
    const link = document.createElement('a');
    link.href = (window as any).URL.createObjectURL(blob);
    link.download = `Audit_Report_${this.eventId}.xlsx`;
    link.click();
  });
}
