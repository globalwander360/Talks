To replicate the CXT Prod Code input exactly like the Customer Category implementation, where options come from an Observable and are retrieved using a storeService + apistaticdata method, follow the below approach.


---

âœ… 1. HTML Template (.html)

<div class="input-row">
  <p>CXT Prod Code</p>
  <ng-dpw-multi-select
    [options]="(cxtProdCodeOptions$ | async)"
    [resetFilterOnHide]="true"
    [style]="{ width: '100%' }"
    formControlName="cxtProdCode"
    (change)="onChange($event.value, 'cxtProdCode')"
  ></ng-dpw-multi-select>
</div>


---

âœ… 2. Component File (.ts)

cxtProdCodeOptions$: Observable<SelectItem[]> = this.store
  .select(getProcessingEntityId)
  .pipe(
    switchMap((selectedProcessingEntityId) =>
      this.dataservice.getCxtProdCode(selectedProcessingEntityId).pipe(
        map((prodCodes: CxtProdCode[]) =>
          entitiesToCRUDOptions(
            prodCodes,
            'code', // property from CxtProdCode object
            null,
            { code: 'None' },
            'code',
            true
          )
        )
      )
    )
  );


---

âœ… 3. Data Service Method

getCxtProdCode(processingEntity: string): Observable<CxtProdCode[]> {
  return this.storeService.checkInStore<CxtProdCode[]>(
    StaticDataType.CXT_PROD_CODE,
    this.apistaticdata.getCxtProdCode(processingEntity, 'BNPPUID'),
    processingEntity
  );
}


---

âœ… 4. API Service Stub

Ensure apistaticdata.getCxtProdCode exists:

getCxtProdCode(processingEntity: string, userId: string): Observable<CxtProdCode[]> {
  // Replace with actual HTTP call logic
  return this.http.get<CxtProdCode[]>(`/api/cxt-prod-code?entity=${processingEntity}&user=${userId}`);
}


---

âœ… 5. Static Data Type Enum

If not present, add this:

export enum StaticDataType {
  CUSTOMER_CATEGORY = 'CUSTOMER_CATEGORY',
  CXT_PROD_CODE = 'CXT_PROD_CODE',
  // Add others if needed
}


---

ðŸ’¡ Notes

Replace 'code' with the actual field name if your CxtProdCode model uses a different property like prodCode or type.

entitiesToCRUDOptions is assumed to transform the data into SelectItem[].



---

Let me know if you want me to generate interface/model CxtProdCode or the backend call too.

